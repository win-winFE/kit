{"version":3,"sources":["../../src/shence/config.js"],"names":["sdk_url","heatmap_url","config","option","web_url","name","use_app_track","use_client_time","show_log","heatmap","clickmap","scroll_notice_map","isTrackLink","loadTimeout","scroll_delay_time","isInApp","navigator","userAgent","indexOf","init","para","p","n","w","window","d","document","s","x","y","a","_q","push","arguments","ifs","i","length","call","_t","createElement","getElementsByTagName","async","src","setAttribute","parentNode","insertBefore","diy","options","eventQueue","isReady","isBind","bizType","registerPage","ready","fn","bindReady","addEventListener","execFn","attachEvent","doScroll","documentElement","error","setTimeout","index","start","Date","addEvent","el","leave","end","duration","sensors","track","pageStayTime","pageUrl","location","href","createTime","onbeforeunload","body","e","obj","toElement","getAttribute","quick","source","module","exports"],"mappings":"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","file":"config.js","sourcesContent":["'use strict';\nimport getUrlParam from '../getUrlParam';\nimport format from '../format';\n\n/**\n * js sdk url\n */\nvar sdk_url = `https://8.yingyinglicai.com/lyfe/common/kit/lib/1.13.12/sensorsdata.min.js`;\nvar heatmap_url = `https://8.yingyinglicai.com/lyfe/common/kit/lib/1.13.12/heatmap.min.js`;\n\nvar config = {\n  option: {\n    web_url: 'https://sensorsdata.yingyinglicai.com/',\n    sdk_url: sdk_url,\n    heatmap_url: heatmap_url,\n    name: 'sensors',\n    use_app_track: true,\n    use_client_time: true,\n    show_log: false,\n    heatmap: {\n      clickmap: 'default',\n      scroll_notice_map: 'default',\n      isTrackLink: false,\n      loadTimeout: 3000,\n      scroll_delay_time: 4000\n    }\n  },\n\n  /**\n   * in app or not in app\n   * if in app sync distinct_id\n   * old sdk\n   * discarded\n   */\n  isInApp: function () {\n    if (navigator.userAgent.indexOf('lyWb') > -1) {\n      return true\n    } else {\n      return false\n    }\n  },\n\n  /**\n   * create script\n   * append js sdk\n   */\n  init: function (para) {\n    let p = para.sdk_url, n = para.name, w = window, d = document, s = 'script', x = null, y = null;\n    w['sensorsDataAnalytic201505'] = n;\n    w[n] = w[n] || function (a) {\n      return function () {\n        (w[n]._q = w[n]._q || []).push([a, arguments]);\n      }\n    };\n    var ifs = ['track', 'quick', 'register', 'registerPage', 'registerOnce', 'trackSignup', 'trackAbtest', 'setProfile', 'setOnceProfile', 'appendProfile', 'incrementProfile', 'deleteProfile', 'unsetProfile', 'identify', 'login', 'logout', 'trackLink', 'clearAllRegister', 'getAppStatus'];\n    for (let i = 0; i < ifs.length; i++) {\n      w[n][ifs[i]] = w[n].call(null, ifs[i]);\n    }\n    if (!w[n]._t) {\n      x = d.createElement(s), y = d.getElementsByTagName(s)[0];\n      x.async = 1;\n      x.src = p;\n      x.setAttribute('charset', 'UTF-8');\n      y.parentNode.insertBefore(x, y);\n      w[n].para = para;\n    }\n  },\n\n  /**\n   * diy shence event\n   */\n  diy: function (options) {\n    let eventQueue = [];\n    let isReady = false;\n    let isBind = false;\n    if (options.bizType) {\n      window[options.name].registerPage({\n        bizType: options.bizType,\n      });\n    }\n\n    function ready(fn) {\n      if (isReady) {\n        fn.call(window);\n      } else {\n        eventQueue.push(fn);\n      }\n      bindReady();\n    }\n\n    function bindReady() {\n      if (isReady) return;\n      if (isBind) return;\n      isBind = true;\n      if (window.addEventListener) {\n        document.addEventListener('DOMContentLoaded', execFn, false);\n      } else if (window.attachEvent) {\n        doScroll();\n      }\n\n    }\n\n    function doScroll() {\n      try {\n        document.documentElement.doScroll('left');\n      } catch (error) {\n        return setTimeout(doScroll, 20);\n      }\n      execFn();\n    }\n\n    function execFn() {\n      if (!isReady) {\n        isReady = true;\n        for (var index = 0; index < eventQueue.length; index++) {\n          eventQueue[index].call(window);\n        }\n        eventQueue = [];\n      }\n    }\n\n    // dom ready do some things\n    ready(function () {\n      var start = new Date();\n\n      function addEvent(el, name, fn) {\n        if (el.addEventListener) return el.addEventListener(name, fn, false);\n        return el.attachEvent('on' + name, fn);\n      }\n\n      // page retention time\n      var leave = function () {\n        var end = new Date();\n        var duration = (end * 1 - start * 1) / 1000;\n        sensors.track('WebEnd', {\n          pageStayTime: duration,\n          pageUrl: window.location.href,\n          createTime: format(new Date(), 'YYYY-MM-DD hh:mm:ss')\n        });\n      };\n\n      window.onbeforeunload = function () {\n        leave();\n      };\n\n      addEvent(window, 'pagehide', leave);\n\n      // click hotspots\n      addEvent(document.body, 'click', function (e) {\n        var obj = e.toElement;\n        obj.getAttribute('shence') === \"true\" || obj.getAttribute('shence') === true ? sensors.quick('trackHeatMap', obj) : void 0;\n      });\n\n      // source path of your website\n      var source = getUrlParam('web_url_source') || '未知';\n      if (config.isInApp()) {\n        sensors.quick('autoTrack', {\n          source: source,\n        });\n      } else {\n        sensors.quick('autoTrack');\n      }\n\n      // error report\n      // window.onerror = function (msg) {\n      //     sensors.track('WebError', {\n      //         error: msg,\n      //     });\n      // }\n\n    });\n  }\n};\nmodule.exports = config;\n"]}