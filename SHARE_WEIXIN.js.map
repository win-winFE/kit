{"version":3,"sources":["../src/SHARE_WEIXIN.js"],"names":["regularUrl","array","location","search","replace","split","result","map","item","indexOf","push","href","join","name","SHARE_WEIXIN","shareData","channel","BROWSER","isWeixin","script","document","createElement","setAttribute","async","type","onload","onreadystatechange","url","window","fetch","get","encodeURI","res","data","wxConfig","signature","getElementsByTagName","appendChild","onerror","Error","wxLoadError","appid","config","timestamp","noncestr","wx","debug","appId","nonceStr","jsApiList","ready","GOKU","shareObj","shareDataError","title","icon","shareDesc","jumpUrl","onMenuShareAppMessage","desc","friendContent","link","imgUrl","onMenuShareTimeline","onMenuShareQQ","qqContent","onMenuShareWeibo","sinaContent","error","e","console","errMsg"],"mappings":"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","file":"SHARE_WEIXIN.js","sourcesContent":["'use strict';\n\n/**\n * todo SHARE\n */\nimport BROWSER from './BROWSER';\nimport fetch from './fetch';\nimport getUrlParam from './getUrlParam';\nimport {shareDataError, wxLoadError, wxConfigError, shareType} from './share/config';\n\nfunction regularUrl() {\n  if (getUrlParam('from')) {\n    const array = location.search.replace('?', '').split('&');\n    let result = [];\n    array.map(item => {\n      if (item.indexOf('from') === -1 && item.indexOf('isappinstalled') === -1) {\n        result.push(item)\n      }\n    });\n    location.href = location.href.split('?')[0] + '?' + result.join('&');\n  }\n}\n\nvar name = 'SHARE_WEIXIN';\nvar SHARE_WEIXIN = (shareData, channel = 'https://gift.yingyinglicai.com/activity/weixin/signature.do') => {\n  if (BROWSER.isWeixin) {\n    regularUrl();\n    var script = document.createElement('script');\n    script.setAttribute('src', 'https://8.yingyinglicai.com/lyfe/common/kit/lib/weixin-1.0.0.js');\n    script.async = \"async\";\n    script.setAttribute(\"charset\", \"UTF-8\");\n    script.type = \"text/javascript\";\n    script.onload = script.onreadystatechange = function () {\n      const url = window.location.href;\n      fetch.get(channel, {url: encodeURI(encodeURI(url))}, res => {\n        if ('data' in res) {\n          let {data} = res;\n          wxConfig(data);\n        } else {\n          let {signature} = res;\n          wxConfig(signature);\n        }\n      });\n    };\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n    script.onerror = function () {\n      throw new Error(wxLoadError)\n    };\n  }\n  var wxConfig = config => {\n    var {appid, timestamp, noncestr, signature} = config;\n    if (!wx) {\n      throw new Error(wxLoadError)\n    }\n    wx.config({\n      debug: false,\n      appId: appid,\n      timestamp: timestamp,\n      nonceStr: noncestr,\n      signature: signature,\n      jsApiList: [\n        'onMenuShareTimeline',\n        'onMenuShareAppMessage',\n        'onMenuShareQQ',\n        'onMenuShareWeibo'\n      ]\n    });\n    wx.ready(_ => {\n      if (!shareData) {\n        if (typeof GOKU.shareObj === 'object') {\n          shareData = GOKU.shareObj\n        } else {\n          throw new Error(shareDataError)\n        }\n      }\n      let {title, icon, shareDesc, jumpUrl} = shareData;\n      if (jumpUrl === '') {\n        jumpUrl = location.href;\n      }\n      wx.onMenuShareAppMessage({\n        title: title,\n        desc: shareType(shareData).friendContent != '' ? shareType(shareData).friendContent : shareDesc,\n        link: jumpUrl,\n        imgUrl: icon\n      });\n      wx.onMenuShareTimeline({\n        title: title,\n        link: jumpUrl,\n        imgUrl: icon\n      });\n      wx.onMenuShareQQ({\n        title: title,\n        desc: shareType(shareData).qqContent != '' ? shareType(shareData).qqContent : shareDesc,\n        link: jumpUrl,\n        imgUrl: icon\n      });\n      wx.onMenuShareWeibo({\n        title: title,\n        desc: shareType(shareData).sinaContent != '' ? shareType(shareData).sinaContent : shareDesc,\n        link: jumpUrl,\n        imgUrl: icon\n      });\n    });\n    wx.error(function (e) {\n      console.error('错误信息：' + e.errMsg + ',jsApiList:' + JSON.stringify(e.jsApiList))\n    });\n  }\n};\nexport default SHARE_WEIXIN;\n"]}